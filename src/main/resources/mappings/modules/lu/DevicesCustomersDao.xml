<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jeeplus.modules.lu.dao.DevicesCustomersDao">

	<!--设备统计-->
	<select id="findList" resultType="com.jeeplus.modules.lu.entity.DevicesCustomers">
		SELECT d.did as id,d.devicemodel,d.name as devicesName,d.devicetype as devicesType ,c.`Name` as customersName,d.state,c.InstallTime as installTime,
		c.DueTime as dueTime,c.InstallPerson as installPerson,c.QualityPerson as qualityPerson
		FROM `devices` d left JOIN customers c on d.customerid=c.CID
		WHERE
		1=1
		<if test="id != null and id !='' and id != '1'.toString()">
			AND  c.CreateBy =#{id}
		</if>
		ORDER BY d.createtime DESC
	</select>
	<!--根据所属客户或者设备类型查询不同的客户id-->
	<select id="totalDevicesCustomersBySelect" resultType="com.jeeplus.modules.lu.entity.DevicesCustomers">
		SELECT d.did as id,d.devicemodel,d.name as devicesName,d.devicetype as devicesType ,c.`Name` as customersName,d.state,c.InstallTime as installTime,
		c.DueTime as dueTime,c.InstallPerson as installPerson,c.QualityPerson as qualityPerson
		FROM `devices` d left JOIN customers c on d.customerid=c.CID
		<where>
			1=1
			<if test="customeridList!=null and customeridList!=''">
				AND d.customerid in
				<foreach item="item" index="index" collection="customeridList"
						 open="(" separator="," close=")">
					#{item}
				</foreach>
			</if>
			<if test="devicesType!=null and devicesType!= ''">
				and d.devicetype =#{devicesType}
			</if>
			<if test="id != null and id !='' and id != '1'.toString()">
				AND  c.CreateBy =#{id}
			</if>
		</where>
		ORDER BY d.createtime DESC
	</select>
</mapper>